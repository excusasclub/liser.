{% extends 'partials/base.html' %}
{% load static %}

{% block title %}Editar: {{ baglist.title }} | Liser{% endblock %}

{% block content %}
<div class="flex min-h-screen">

    <!-- Sidebar -->
    {% include 'partials/sidebar.html' %}

    <!-- Contenido principal -->
    <main class="flex-1 p-6">

        <!-- Panel principal de metadatos -->
        <section class="mb-6 rounded-xl shadow-lg mx-auto max-w-4xl bg-[#99CB8A]/30 border border-[#8AB77A]/50">
            <div class="flex items-center justify-between px-4 py-2">
                <h2 class="flex-1 text-center text-lg font-semibold text-gray-900 truncate">
                    Editar BagList
                </h2>
            </div>

            <!-- Formulario de edición -->
            <form method="post" class="px-4 py-4 space-y-4">
                {% csrf_token %}

                <div>
                    {{ form.title.label_tag }}
                    {{ form.title }}
                    {% if form.title.errors %}
                        <p class="text-red-500 text-sm">{{ form.title.errors }}</p>
                    {% endif %}
                </div>

                <div>
                    {{ form.description.label_tag }}
                    {{ form.description }}
                    {% if form.description.errors %}
                        <p class="text-red-500 text-sm">{{ form.description.errors }}</p>
                    {% endif %}
                </div>

                <div>
                    {{ form.visibility.label_tag }}
                    {{ form.visibility }}
                    {% if form.visibility.errors %}
                        <p class="text-red-500 text-sm">{{ form.visibility.errors }}</p>
                    {% endif %}
                </div>

                <div>
                    {{ form.cover_image_url.label_tag }}
                    {{ form.cover_image_url }}
                    {% if form.cover_image_url.errors %}
                        <p class="text-red-500 text-sm">{{ form.cover_image_url.errors }}</p>
                    {% endif %}
                </div>

                <div class="flex items-center space-x-2">
                    {{ form.allow_forks }}
                    {{ form.allow_forks.label_tag }}
                    {% if form.allow_forks.errors %}
                        <p class="text-red-500 text-sm">{{ form.allow_forks.errors }}</p>
                    {% endif %}
                </div>

                <div class="flex justify-end">
                    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                        Guardar cambios
                    </button>
                </div>
            </form>
        </section>

        <!-- Secciones editables -->
        <section class="mx-auto max-w-4xl mb-4">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-lg font-semibold text-gray-900">Secciones</h3>
                <button class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 text-sm"
                        onclick="createSection('{{ baglist.id }}')">+ Nueva sección</button>
            </div>

            {% for section in baglist.sections.all %}
                {% include 'partials/baglist_section_edit.html' with section=section %}
            {% empty %}
            <div class="text-center text-gray-600 py-6 border rounded-lg bg-gray-50">
                No hay secciones en esta lista.
            </div>
            {% endfor %}
        </section>

    </main>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/baglist_edit.js' %}"></script>
{% endblock %}
